# ActionFlow Desktop Automator

## 📋 프로젝트 개요

**제작자**: Photometry4040  
**저작권**: © 2025 Photometry4040. All rights reserved.

> **중요**: 이 소프트웨어를 배포하거나 수정할 때는 반드시 저작권 표시를 명기해주세요.

**ActionFlow Desktop Automator**는 로컬 PC용 반복 업무 자동화 도구입니다. 개인 사용자가 마우스/키보드 작업을 순차적으로 저장하고 실행할 수 있는 간단한 데스크톱 애플리케이션입니다.

### 🎯 핵심 특징
- **단일 .exe 파일로 배포 가능**한 간단한 구조
- **JSON 기반 데이터 저장** (SQLite 제거)
- 직관적이고 빠른 GUI 인터페이스
- 개인 사용자에 최적화된 기능

## 🚀 빠른 시작

### 설치 요구사항
- Python 3.8 이상
- Windows 10/11, macOS 10.15+, Ubuntu 18.04+

#### 선택적 의존성 (고급 기능)
- **OpenCV** (`opencv-python`): 이미지 인식 기능 사용 시
- **Pandas** (`pandas`): Excel/CSV 데이터 연동 사용 시
- **openpyxl**: Excel 파일(.xlsx) 처리 시

> **참고**: 선택적 의존성이 설치되지 않은 경우 해당 기능이 비활성화되며, 나머지 기능은 정상 동작합니다.

### 개발 환경 설정
```bash
# 1. 프로젝트 클론
git clone <repository-url>
cd actionflow_desktop

# 2. 가상환경 생성 및 활성화
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. 의존성 설치
pip install -r requirements.txt

# 4. 애플리케이션 실행
python main.py
```

### 테스트 실행
```bash
# 모든 테스트 실행
python run_tests.py

# 개별 테스트 실행
python tests/test_permissions.py      # 권한 테스트
python tests/test_mouse_action.py     # 마우스 액션 테스트
python tests/test_dialog.py           # 다이얼로그 테스트
python tests/test_action_dialog.py    # 액션 다이얼로그 테스트
```

### 배포
```bash
# 자동 빌드 스크립트 사용 (권장)
python build.py

# 수동 빌드
pyinstaller --onefile --windowed main.py
```

## 📁 프로젝트 구조

```
actionflow_desktop/
├── main.py                 # 메인 애플리케이션 진입점
├── requirements.txt        # Python 의존성
├── README.md              # 프로젝트 문서
├── src/
│   ├── gui/               # GUI 관련 모듈
│   ├── core/              # 핵심 로직
│   ├── models/            # 데이터 모델
│   ├── utils/             # 유틸리티
│   └── resources/         # 리소스 파일
├── data/                  # JSON 데이터 저장소
├── tests/                 # 테스트 코드
└── docs/                  # 문서
```

## 🎯 주요 기능

### 1. 프로젝트 관리
- 프로젝트 생성/수정/삭제
- 프로젝트별 액션 시퀀스 저장
- 프로젝트 목록 및 검색
- 프로젝트 카테고리 분류

### 2. 액션 관리
- 마우스 이동/클릭
- 키보드 입력
- **키 입력** (Delete, Backspace, Enter 등 특수 키) 🆕
- 복사/붙여넣기
- 지연 시간
- 키 조합 (Ctrl+C, Ctrl+V 등)
- **액션 복사/붙여넣기** (Ctrl+C/V) 🆕
- **드래그 앤 드롭으로 순서 변경** 🆕

### 3. 실행 기능
- 프로젝트 전체 실행
- 개별 액션 실행
- 실행 중 중단 (ESC 키)
- 실행 속도 조절

### 4. 코드 생성
- Python 스크립트 생성
- 실행 가능한 .py 파일 저장

### 5. 고급 기능 (Phase 3)
- 매크로 녹화 기능
- 설정 관리 시스템
- 백업/복원 기능
- 템플릿 관리

### 6. 최적화 기능 (Phase 4)
- 실행 히스토리 관리
- 고급 매크로 기능 (조건부 실행, 반복 설정)
- 성능 최적화 (메모리 관리, 캐싱)
- 현대적 테마 시스템
- **로깅 시스템** (일별 로그 파일, 로그 레벨 설정)
- **에러 처리 개선** (상세한 예외 추적 및 복구)
- **JSON 스키마 검증** (데이터 무결성 보장)
- **손상된 파일 자동 복구**
- **실행 상태 모니터링** 🆕
  - 실시간 진행률 표시
  - 현재 액션 및 총 액션 수 표시
  - 경과 시간 및 예상 남은 시간 계산
  - 액션당 평균 실행 시간 통계
  - 실행 상태 확인 다이얼로그 (F9 단축키)

### 7. 액션 관리 UX 개선 (Phase 6) 🆕
**생산성을 대폭 향상시키는 사용자 경험 개선**

#### 빠른 액션 삭제
- **Delete 키 단축키**: 선택한 액션을 빠르게 삭제 (확인 포함)
- **Shift+Delete**: 확인 없이 즉시 삭제 (대량 삭제 시 유용)
- **작업 시간 66% 단축**: 기존 3번 클릭 → 1번 키 입력

#### 우클릭 컨텍스트 메뉴
- **액션에서 우클릭**: 모든 작업을 한 곳에서
- **메뉴 항목**:
  - 액션 편집
  - 액션 복사/붙여넣기
  - 위로/아래로 이동
  - 액션 삭제 (확인 포함/생략)
- **직관적인 워크플로우**: 마우스만으로도 빠른 작업

#### 액션 복사/붙여넣기
- **Ctrl+C**: 선택한 액션 복사
- **Ctrl+V**: 복사한 액션을 원하는 위치에 붙여넣기
- **딥 카피**: 원본과 독립적인 복사본 생성
- **자동 순서 정렬**: 붙여넣기 후 자동으로 순서 재정렬

#### 드래그 앤 드롭
- **마우스로 끌어서 이동**: 직관적인 순서 변경
- **실시간 피드백**: 드래그 중 목표 위치 하이라이트
- **자동 순서 정렬**: 드롭 후 자동으로 순서 재정렬

#### 버그 수정
- **순서 재정렬 버그**: 액션 삭제 후 순서가 1부터 재정렬되지 않던 문제 해결
- **안정성 향상**: 모든 액션 조작 시 순서 자동 재정렬

### 8. 데이터 관리 기능 (Phase 4 확장) 🆕
**효율적인 프로젝트 및 액션 관리**

#### 프로젝트 검색 및 필터링
- **통합 검색바**: 프로젝트명, 설명, 액션 내용을 실시간으로 검색
- **고급 필터**:
  - 카테고리별 필터링
  - 태그별 필터링
  - 즐겨찾기만 보기
  - 최근 실행 프로젝트만 보기
- **필터 조합**: 여러 필터를 동시에 적용 가능
- **검색 결과 실시간 업데이트**: 입력하는 즉시 결과 반영

#### 최근 실행 프로젝트 관리
- **자동 기록**: 프로젝트 실행 시 자동으로 최근 목록에 추가
- **최대 10개 유지**: 가장 최근 10개 프로젝트만 표시
- **빠른 접근**: 최근 실행 필터로 자주 사용하는 프로젝트에 빠르게 접근
- **시각적 표시**: 🕒 아이콘으로 최근 실행 프로젝트 표시

#### 액션 태그 시스템
- **태그 지원**: 액션에 태그를 추가하여 분류 및 관리
- **태그 검색**: 특정 태그를 가진 액션이 포함된 프로젝트 찾기
- **유연한 분류**: 프로젝트 카테고리와 별도로 액션 단위 분류 가능
- **자동 태그 목록**: 사용 중인 모든 태그를 자동으로 수집

#### 프로젝트 Import/Export (기존 기능 강화)
- **JSON 형식**: 프로젝트를 JSON 파일로 내보내기
- **PC 간 이동**: 다른 컴퓨터로 프로젝트 쉽게 이동
- **백업 용도**: 중요한 프로젝트 별도 백업
- **ID 자동 재할당**: 가져오기 시 충돌 방지

### 9. 고급 자동화 기능 (Phase 5) 🆕
#### 이미지 인식 기반 자동화
- **OpenCV 기반 이미지 매칭**: UI 요소를 이미지로 인식하여 클릭
- **동적 UI 대응**: 좌표 기반이 아닌 이미지 기반 클릭으로 해상도/레이아웃 변경에도 동작
- **신뢰도 조절**: 매칭 신뢰도를 조절하여 유연한 인식
- **템플릿 캐싱**: 성능 향상을 위한 이미지 캐싱
- **주요 기능**:
  - `이미지 클릭`: 화면에서 이미지를 찾아 클릭
  - `이미지 대기`: 특정 이미지가 나타날 때까지 대기
  - `이미지 찾기`: 화면에서 이미지 검색
  - `여러 이미지 대기`: 여러 이미지 중 하나가 나타날 때까지 대기

#### Excel/CSV 데이터 연동
- **Pandas 기반 데이터 처리**: Excel/CSV 파일 읽기 및 쓰기
- **데이터 루프**: 행 단위 반복 처리로 대량 작업 자동화
- **필터링 기능**: 조건에 맞는 데이터만 처리
- **중첩 루프 지원**: 복잡한 데이터 처리 시나리오
- **주요 기능**:
  - `Excel/CSV 로드`: 데이터 파일 불러오기
  - `루프 시작`: 각 행을 순회하며 자동화 실행
  - `셀 값 가져오기`: 특정 컬럼의 값을 가져와 사용
  - `결과 저장`: 처리 결과를 새 파일로 저장

**사용 예시**: Excel 파일의 고객 목록을 읽어 각 고객에게 자동으로 이메일 전송, 웹사이트에서 데이터를 추출하여 Excel로 저장 등

📚 **상세 가이드**: [고급 기능 활용 가이드](docs/ADVANCED_FEATURES.md) 참조

## 📊 데이터 구조

### JSON 기반 데이터 저장
- `data/projects.json` - 프로젝트 및 액션 데이터
- `data/settings.json` - 사용자 설정
- `data/templates.json` - 액션 템플릿

사용자가 직접 JSON 파일을 확인하고 편집할 수 있습니다.

### 로그 파일 위치
- **Windows**: `%APPDATA%/ActionFlow/logs/actionflow_YYYYMMDD.log`
- **macOS**: `~/Library/Application Support/ActionFlow/logs/actionflow_YYYYMMDD.log`
- **Linux**: `~/.config/ActionFlow/logs/actionflow_YYYYMMDD.log`

로그 파일은 일별로 자동 생성되며, 최대 5개까지 보관됩니다 (각 10MB 제한).

## 🛠️ 개발 가이드라인

### 개발 완료 상태
- ✅ **Phase 1**: 기본 구조 및 프로젝트 관리
- ✅ **Phase 2**: 액션 관리 및 실행 엔진
- ✅ **Phase 3**: 고급 기능 (코드 생성, 백업/복원, 설정 관리)
- ✅ **Phase 4**: 최적화 및 배포 (히스토리, 성능 최적화, 빌드 시스템)
- ✅ **Phase 5**: 고급 자동화 (이미지 인식, Excel/CSV 연동)

### 코딩 스타일
- PEP 8 준수
- 함수/클래스에 docstring 필수
- 변수명은 snake_case
- 클래스명은 PascalCase

### 테스트
```bash
# 테스트 실행
pytest

# 코드 포맷팅
black .

# 린팅
flake8
```

## 📝 저작권 및 라이선스

**제작자**: Photometry4040  
**저작권**: © 2025 Photometry4040. All rights reserved.

### 📋 라이선스 조건
- 이 소프트웨어는 개인 및 상업적 용도로 사용할 수 있습니다.
- **배포 시 반드시 저작권 표시를 명기해주세요.**
- 소스 코드 수정 시에도 원본 저작권 표시를 유지해야 합니다.
- 무단 배포 및 상업적 이용은 금지됩니다.

### 🔒 보안 정책
- 모든 데이터는 로컬에만 저장됩니다.
- 외부 네트워크 연결이 없습니다.
- 사용자 입력은 철저히 검증됩니다.
- 실행 중 안전 장치(ESC 키)가 구현되어 있습니다.
- 데이터 암호화 및 백업 기능이 포함되어 있습니다.

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📞 문의

프로젝트에 대한 문의사항이 있으시면 이슈를 생성해 주세요.

---

## 🎯 성능 목표 달성

- ✅ **앱 시작 시간**: 3초 이내
- ✅ **액션 실행 지연**: 100ms 이내
- ✅ **메모리 사용량**: 100MB 이하 (최적화 기능으로 관리)
- ✅ **프로젝트 저장**: 1초 이내
- ✅ **실행 중 응답성**: ESC 키 즉시 반응
- ✅ **배포**: 단일 실행 파일 (20MB) 생성 완료

## 🚀 배포 완료

- **실행 파일**: `dist/ActionFlow` (macOS/Linux) 또는 `dist/ActionFlow.exe` (Windows)
- **패키지**: `package/` 디렉토리에 배포용 파일들
- **빌드 스크립트**: `python build.py`로 자동 빌드

---

## 🗺️ 향후 개발 계획 (Roadmap)

### Phase 7: 고급 제어 기능 (계획 중)
**예상 개발 기간**: 2-3주

#### 1. 에러 처리 및 재시도 ⭐⭐ 우선순위 높음
- **에러 발생 시 옵션**:
  - 오류 발생 시 중단
  - 오류 무시하고 계속 진행
  - 해당 액션 N번 재시도
  - 특정 액션으로 이동 (에러 핸들링 블록)
- **타임아웃 설정**: 각 액션별 최대 실행 시간 지정
- **안정성 향상**: 네트워크 지연, 로딩 시간 등에 대응

#### 2. 조건부 실행 (If/Else) ⭐⭐ 우선순위 높음
- **조건 타입**:
  - 이미지 존재 여부
  - 클립보드 내용 확인
  - 변수 값 비교
  - Excel 데이터 조건
- **분기 처리**: 조건에 따라 다른 액션 실행
- **유연한 자동화**: 상황에 맞는 동적 처리

#### 3. 변수 시스템 ⭐
- **변수 저장**:
  - 클립보드 내용을 변수에 저장
  - 이미지 인식 결과 저장
  - Excel 셀 값 저장
- **변수 사용**:
  - 키보드 입력에 변수 삽입
  - 조건문에서 변수 비교
  - 액션 파라미터에 변수 사용

#### 4. 반복 (Loop) 기능 ⭐
- **반복 횟수 지정**: 특정 액션 그룹을 N번 반복
- **무한 반복**: 중단할 때까지 계속 실행
- **조건부 반복**: 특정 조건이 만족될 때까지 반복
- **Excel 루프 외 범용 반복**: 일반적인 반복 작업 간소화

### Phase 8: 편의성 기능 (계획 중)
**예상 개발 기간**: 2-3주

#### 1. 전역 핫키 (Global Hotkey) ⭐⭐ 우선순위 높음
- **백그라운드 실행**: 프로그램이 최소화되어 있어도 작동
- **빠른 실행**:
  - Ctrl+Alt+1: 즐겨찾기 프로젝트 1 실행
  - Ctrl+Alt+2: 즐겨찾기 프로젝트 2 실행
  - 사용자 정의 단축키 설정
- **생산성 향상**: 다른 프로그램 사용 중에도 즉시 자동화 실행

#### 2. 실행 스케줄러 ⭐
- **시간 기반 실행**:
  - 매일 오전 9시에 실행
  - 매주 월요일 오후 2시에 실행
  - 1시간마다 반복 실행
- **이벤트 기반 실행**:
  - 파일 생성/수정 시 실행
  - 시스템 시작 시 실행
- **무인 자동화**: 정기 작업 자동 처리

#### 3. 실행 로그 뷰어 ⭐
- **실행 내역 조회**:
  - 언제 어떤 프로젝트를 실행했는지
  - 각 액션별 성공/실패 여부
  - 실행 시간, 에러 메시지
- **로그 검색 및 필터링**: 특정 날짜/프로젝트/에러만 조회
- **문제 추적**: 오류 발생 시 원인 분석

#### 4. 화면 캡처 및 주석 ⭐
- **자동 스크린샷**:
  - 마우스 클릭 위치 자동 캡처
  - 이미지 인식 대상 미리보기
- **액션 주석**:
  - 각 액션에 메모/설명 추가
  - 스크린샷 첨부
- **가독성 향상**: 나중에 액션 내용 이해하기 쉬움

### Phase 9: 웹 자동화 (고급, 장기 계획)
**예상 개발 기간**: 4-6주

#### 웹 자동화 지원
- **Selenium 통합**: 브라우저 제어
- **주요 기능**:
  - URL 열기
  - 웹 요소 클릭 (XPath, CSS Selector)
  - 폼 입력 및 제출
  - 웹 데이터 추출
- **안정성**: 웹 페이지 로딩 대기, 동적 콘텐츠 처리
- **활용 예시**:
  - 웹사이트 데이터 자동 수집
  - 반복적인 웹 폼 작성
  - 웹 기반 업무 자동화

### Phase 10: 엔터프라이즈 기능 (장기 계획)
**예상 개발 기간**: 6-8주

#### 고급 기능
- **다중 프로젝트 실행**: 여러 프로젝트를 순차/병렬 실행
- **프로젝트 공유**: 팀원과 프로젝트 공유 및 버전 관리
- **클라우드 동기화**: 여러 PC에서 동일한 프로젝트 사용
- **API 제공**: 외부 프로그램에서 ActionFlow 제어
- **플러그인 시스템**: 사용자 정의 확장 기능

---

## 📅 개발 우선순위

### 즉시 개발 (1-2주 이내)
1. ⭐⭐ 에러 처리 및 재시도 - **가장 높은 우선순위**
2. ⭐⭐ 조건부 실행 (If/Else) - **유연성 대폭 향상**
3. ⭐⭐ 전역 핫키 - **사용성 크게 개선**

### 단기 개발 (1-2개월 이내)
4. ⭐ 변수 시스템
5. ⭐ 반복 (Loop) 기능
6. ⭐ 실행 스케줄러
7. ⭐ 실행 로그 뷰어
8. ⭐ 화면 캡처 및 주석

### 장기 개발 (3-6개월 이내)
9. 웹 자동화 (Selenium)
10. 엔터프라이즈 기능

---

## 🎯 성능 목표 달성

- ✅ **앱 시작 시간**: 3초 이내
- ✅ **액션 실행 지연**: 100ms 이내
- ✅ **메모리 사용량**: 100MB 이하 (최적화 기능으로 관리)
- ✅ **프로젝트 저장**: 1초 이내
- ✅ **실행 중 응답성**: ESC 키 즉시 반응
- ✅ **배포**: 단일 실행 파일 (20MB) 생성 완료
- ✅ **UX 개선**: 액션 관리 작업 시간 40-66% 단축

## 🚀 배포 완료

- **실행 파일**: `dist/ActionFlow` (macOS/Linux) 또는 `dist/ActionFlow.exe` (Windows)
- **패키지**: `package/` 디렉토리에 배포용 파일들
- **빌드 스크립트**: `python build.py`로 자동 빌드

---

**ActionFlow Desktop Automator** - 간단하고 효율적인 데스크톱 자동화 도구 🚀 